**For steps 1 - 8 start from this starting boilerplate: [empty boilerplate](https://github.com/kujain/S22-5505_Javascript/blob/main/workflow_boilerplate_starter.zip)**

**For step 9, use this boilerplate: [es6 modules boilerplate](https://github.com/kujain/S22-5505_Javascript/blob/main/workflow_boilerplate_es6_complete.zip)**

# 1. Start:

Note, if you node version is v13 or later (current is v16) (check by typing `node -v` and see the resulting version), please downgrade to 16 LTS. V17 is available but it's safes to work with the latest LTS version only. 
```
node -v
brew install node@16
```

Install gulp globally:
```
npm install gulp gulp-cli -g
```

In case of permissions error
```
sudo npm install gulp gulp-cli -g
```

Then restart terminal.

**This completes all the global installation process. The next steps are at the project level. So navigate to your project folder (use the boiletplate folder above for the purpose of this exercise). Then go through the following steps:
**

Get the boilerplate and expand into a folder. cd into that folder. This skeleton will be the starting base for this project. It contains an index.html and basic sass and js files inside the src folder. The subsequent steps will create the gulp tasks needed to generate the actual production ready js and css files in a new dist folder.
Run:
```
npm init
```

Use defaults for most. This will create a package.json file and prepare for the subsequent node packages. If gulp is not installed globally, edit package.json and add this to scripts inside package.json file:
```
"scripts": {
  "test": "echo \"Error: no test specified\" && exit 1",
  "start": "gulp"
},
```

# 2. Install local gulp and other packages

Install v4 of gulp locally:

```
npm install --save-dev gulp
```

Now install the starting packages:

```
npm install --save-dev sass gulp-sass gulp-cssnano gulp-sourcemaps gulp-autoprefixer
```

This will install the above 4 packages and add it to package.json file.


# 3. Update the empty gulpfile.js

Take code and add into  the empty gulpfile.js: 
https://github.com/kujain/S22-5505_Javascript/blob/main/gulpfile-1.js

This sets up the first task: to take all the SCSS files and compile into a single style.css file. Type:
```
gulp
```

Gulp will run and a  new dist folder is created with the generated css file in there. The css file will also be minified through the use of cssnano() gulp package.
Open the index.html file in a browser and it should render using the css file from the dist folder.
Make changes to the scss files in src folder and rerun gulp. gulp will detect them automatically and update the generated css file. Reload the index.html file to see the changes.


# 4. Setup browser sync and watch to run the project from a local web server.

Run:
```
npm install --save-dev browser-sync
```

Update the gulpfile.js with the code from
https://github.com/kujain/S22-5505_Javascript/blob/main/gulpfile-2.js

Then run:
```
gulp
```

Gulp will run and start in the background and a new browser window will start on  the url http://localhost:3000/. This is the root of the server that will host the index.html file.
Change something in the sass files and that update will automatically be detected and rendered in the browser without you having to reload manually!

Having a local server  handling your files has many advantages:
- simulates a proper web serving environment
- can get around many CORS issues that hassle  API access from javascript
- get around file path issues


# 5. Include js in the task runner.
```
npm install --save-dev jshint gulp-rename gulp-concat gulp-jshint
```

Update the gulpfile.js with the code from:
https://github.com/kujain/S22-5505_Javascript/blob/main/gulpfile-3.js

Then run:
```
gulp
```

Now all js files in the src folder will get joined into one scripts.js file in the dist folder. Browsersync will refresh everything a change is made in the js files (and scss files).

Also, you will see some additional lines in the terminal related to js errors and compatibility warnings - these are generated by the linting package. By default linting will include es6 related warnings. To remove them, add a new file called .jshintrc with one json code block:
```
{
   "esversion": 6
}
```

Now es6 warnings will be removed from linting.


# 6. Include jquery within the task runner.
```
npm install --save jquery
```

Update the gulpfile.js with the code from
https://github.com/kujain/S22-5505_Javascript/blob/main/gulpfile-4.js

Then run:
```
gulp
```

Now the generated scripts.js will include jquery in its entirety and you wont need to add it to index.html as a separate script block.


# 7. Minify the generated js

Due to the inclusion of plugins, the js file has  become rather large. Minifying the js file would help is compacting the file.
```
npm install --save-dev gulp-terser
```

Update the gulpfile.js with the code from
https://github.com/kujain/S22-5505_Javascript/blob/main/gulpfile-5.js

Then run:
```
gulp
```
Now, the same js file from previous step will be compressed and minified into a file about a quarter of the original size!


# 8. Add transpiling to auto-convert all es6 and newer code into older format for browser compatibility
```
npm install --save-dev gulp-babel @babel/core @babel/preset-env
```

Update the gulpfile.js with the code from
https://github.com/kujain/S22-5505_Javascript/blob/main/gulpfile-6.js

Then run:
```
gulp
```

Now, all es6 code format will auto-convert into es5 syntax. This gives you so much flexibility in your coding style that its pretty much the best reason for using a task runner!

----

# 9. Working with ES6 modules

ES6 module structure is not compatible with most browsers. To make them usable across all browsers including older ones, they need to be converted into vanilla js. Using the webpack bundler, you can continue to develop using ES6 modules and then compile them into a fixed format for production use.

For this task, use boilerplate_e6.zip file and start from there. The above steps have already been integrated into the gulpfile and package.json so you can simply run npm install to install ALL the packages indexed in that fileL
```
npm install
```

Update the gulpfile.js with the code from
https://github.com/kujain/S22-5505_Javascript/blob/main/gulpfile-7.js

Since this requires webpack, an additional webpack config file is required for it to handle the  bundling process.   Create a  webpack.config.js file and update its content from:
https://github.com/kujain/S22-5505_Javascript/blob/main/webpack.config.js

You also need a `/babelrc` file in the folder, but that's already been provided in this boilerplate for you.

Then run:
```
gulp
```

The generated js converts all the ES6 modules into a flat js file ready for any browser version. It's also minified and optimized.

**NOTE:** The above also includes jQuery framework to serve as an example of importing an external library into your project. You can simply remove it from gulpfile.js if its not required for your project, or use any other library instead.


## GOING FORWARD:

### Please use the above workflow and adapt your upcoming final project into it. Test the steps and make sure that the final files being generated in  the dist folder are correct and working.
